#!/bin/bash
#SBATCH --mem=20G
#SBATCH -a 2-22

c=$SLURM_ARRAY_TASK_ID

hap_zipped=1000GP_Phase3_chr"$c".hap.gz
hap_unzipped=1000GP_Phase3_chr"$c".hap
hap_filtered=chr"$c"_filtered_GWD_IBS.hap
hap_tmp=chr"$c"_hap.tmp
legend_zipped=1000GP_Phase3_chr"$c".legend.gz
legend_unzipped=1000GP_Phase3_chr"$c".legend
legend_filtered=chr"$c"_filtered.legend
rsIDfile=chr"$c"_rsID.tmp
mapfile=chr"$c".map
greppatterns=chr"$c"_greppatterns.tmp
snp_lines=chr"$c"_snp_lines.tmp

gunzip $hap_zipped
gunzip $legend_zipped

cut -f2 -d" " $mapfile > $rsIDfile

awk '{ print ""$0":"}' $rsIDfile > $greppatterns

grep -F -n -f $greppatterns $legend_unzipped | cut -f1,2,3,4 -d" " > $legend_filtered

cut -f1 -d: $legend_filtered > $snp_lines

./get_lines.pl $snp_lines $hap_unzipped > $hap_tmp

cut -d" " -f1893,1894,1895,1896,1899,1900,1969,1970,1971,1972,\
1973,1974,1975,1976,1977,1978,1979,1980,1987,1988,1989,1990,1991,\
1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2013,2014,\
2015,2016,2017,2018,2019,2020,2021,2022,2023,2024,2025,2026,2027,\
2028,2029,2030,2031,2032,2033,2034,2035,2036,2037,2038,2039,2040,\
2041,2042,2043,2044,2065,2066,2067,2068,2069,2070,2071,2072,2073,\
2074,2075,2076,2103,2104,2105,2106,2107,2108,2109,2110,2111,2112,\
2113,2114,2133,2134,2135,2136,2137,2138,2139,2140,2141,2142,2143,\
2144,2145,2146,2147,2148,2149,2150,2175,2176,2177,2178,2179,2180,\
2181,2182,2183,2184,2185,2186,2187,2188,2189,2190,2191,2192,2193,\
2194,2195,2196,2197,2198,2199,2200,2201,2202,2203,2204,2205,2206,\
2207,2208,2209,2210,2211,2212,2213,2214,2215,2216,2217,2218,2219,\
2220,2221,2222,2223,2224,2225,2226,2227,2228,2229,2230,2231,2232,\
2233,2234,2235,2236,2237,2238,2239,2240,2241,2242,2243,2244,2245,\
2246,2247,2248,2287,2288,2289,2290,2311,2312,2315,2316,2317,2318,\
2319,2320,2321,2322,2323,2324,2325,2326,2327,2328,2329,2330,2491,\
2492,2497,2498,2501,2502,2661,2662,2663,2664,1005,1006,1007,1008,\
1009,1010,1011,1012,1013,1014,1015,1016,1017,1018,1019,1020,1021,\
1022,1023,1024,1025,1026,1027,1028,1029,1030,1031,1032,1033,1034,\
1035,1036,1037,1038,1039,1040,1041,1042,1043,1044,1045,1046,1047,\
1048,1049,1050,1051,1052,1091,1092,1093,1094,1095,1096,1097,1098,\
1099,1100,1101,1102,1103,1104,1105,1106,1107,1108,1109,1110,1111,\
1112,1113,1114,1115,1116,1117,1118,1119,1120,1121,1122,1123,1124,\
1125,1126,1127,1128,1129,1130,1131,1132,1133,1134,1135,1136,1137,\
1138,1139,1140,1141,1142,1143,1144,1145,1146,1147,1148,1149,1150,\
1151,1152,1153,1154,1155,1156,1157,1158,1159,1160,1161,1162,1163,\
1164,1165,1166,1167,1168,1169,1170,1171,1172,1173,1174,1175,1176,\
1177,1178,1179,1180,1181,1182,1183,1184,1185,1186,1187,1188,1189,\
1190,1191,1192,1193,1194,1195,1196,1197,1198,1199,1200,1201,1202,\
1203,1204,1205,1206,1207,1208,1209,1210,1211,1212,1213,1214,1215,\
1216,1217,1218,1219,1220,1221,1222,1223,1224,1225,1226,1227,1228,\
1229,1230,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,\
1690,1691,1692,1693,1694,1695,1696,1697,1698,1699,1700,1701,1702,\
1703,1704 $hap_tmp > $hap_filtered

gzip $legend_unzipped
gzip $hap_unzipped